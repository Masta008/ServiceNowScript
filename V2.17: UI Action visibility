//Step one : Presented the result Script from ServiceNow after the run of Instance Scan

++Communitation with ChatGPT++

//User 
//Please program a JavaScript script solution for the following ServiceNow request:
//ServiceNow Field: "Description"
Checks to see if the UI Action can be accessed by a user with no roles who does not have read access to the table.

//ServiceNow Field: "Resolution Details"
Use conditions or visibility criteria to restrict access to UI Actions.

//Answer
To restrict access to a UI Action in ServiceNow for users with no roles who do not have read access to the table, you can use client-side scripting. Here's a JavaScript script that you can use to achieve this:

(function () {
  // Check if the user has any roles
  var userHasRoles = g_user.hasRoles();
  
  // Check if the user has read access to the table
  var userHasReadAccess = g_user.hasReadAccess('YOUR_TABLE_NAME'); // Replace 'YOUR_TABLE_NAME' with the actual table name
  
  // Get the UI Action element (replace 'sysverb_your_ui_action_name' with the actual UI Action sys_id)
  var uiAction = g_form.getActionByName('sysverb_your_ui_action_name');
  
  if (!userHasRoles && !userHasReadAccess) {
    // Disable the UI Action for users with no roles and no read access
    uiAction.setVisible(false);
  } else {
    // Enable the UI Action for other users
    uiAction.setVisible(true);
  }
})();
In this script:

We first check if the user has any roles using g_user.hasRoles().
We then check if the user has read access to the table by using g_user.hasReadAccess('YOUR_TABLE_NAME'). Make sure to replace 'YOUR_TABLE_NAME' with the actual name of the table you want to check read access for.
We get the UI Action element using g_form.getActionByName('sysverb_your_ui_action_name'). Replace 'sysverb_your_ui_action_name' with the actual sys_id of your UI Action.
Depending on the conditions, we either hide or show the UI Action using uiAction.setVisible(false) or uiAction.setVisible(true).
You should add this script to the UI Action's "Client" script field. Make sure to replace 'YOUR_TABLE_NAME' and 'sysverb_your_ui_action_name' with the appropriate values for your use case.

This script will hide the UI Action for users with no roles and no read access to the specified table, effectively restricting access as per your requirements.
