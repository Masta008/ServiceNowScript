//Step one : Presented the result Script from ServiceNow after the run of Instance Scan

++Communitation with ChatGPT++

//User 
//please program a javascript script solution for the following servicenow request:
//ServiceNow Field: "Description"
Checks to see if the UI Action can be accessed by a user with no roles who does not have read access to the table.

//ServiceNow Field: "Resolution Details"
Use conditions or visibility criteria to restrict access to UI Actions.

//ServiceNow Field "Script"
(function(finding, current) {

    var found = true;
    var gr = new GlideRecord("sys_ui_action_view");
    gr.addQuery('sys_ui_action', current.sys_id);
    gr.query();
    if (gr.next()) {
        found = false;
    }
    if (JSUtil.notNil(current.condition)) {
        if (current.condition.includes("gs.hasRole")) {
            found = false;
        }
    }

    var gr2 = new GlideRecord('sys_ui_action_role');
    gr2.addQuery('sys_ui_action', current.sys_id);
    gr2.query();
    if (gr2.next()) {
        found = false;
    }
    if (found) {
        finding.setCurrentSource(current);
        finding.increment();
    }

})(finding, current);
